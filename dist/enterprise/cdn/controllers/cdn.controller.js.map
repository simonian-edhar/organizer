{"version":3,"sources":["../../../../src/enterprise/cdn/controllers/cdn.controller.ts"],"sourcesContent":["import { Controller, Get, Post, Delete, Body, Query, Param, UseGuards, Request } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiBearerAuth } from '@nestjs/swagger';\nimport { CdnService } from '../services/cdn.service';\nimport { JwtAuthGuard, SuperAdminGuard } from '../../../auth/guards';\n\n@ApiTags('CDN')\n@ApiBearerAuth()\n@Controller('v1/cdn')\n@UseGuards(JwtAuthGuard)\nexport class CdnController {\n    constructor(private readonly cdnService: CdnService) {}\n\n    @Get('config')\n    @UseGuards(SuperAdminGuard)\n    @ApiOperation({ summary: 'Get CDN configuration' })\n    getConfig() {\n        return this.cdnService.getConfig();\n    }\n\n    @Post('purge')\n    @UseGuards(SuperAdminGuard)\n    @ApiOperation({ summary: 'Purge CDN cache' })\n    async purgeCache(\n        @Body() body: { urls?: string[]; tags?: string[]; all?: boolean }\n    ) {\n        return this.cdnService.purge(body);\n    }\n\n    @Post('purge/tenant')\n    @ApiOperation({ summary: 'Purge tenant CDN cache' })\n    async purgeTenantCache(@Request() req: any) {\n        return this.cdnService.purgeTenantCache(req.user.tenant_id);\n    }\n\n    @Post('purge/static')\n    @UseGuards(SuperAdminGuard)\n    @ApiOperation({ summary: 'Purge static assets cache' })\n    async purgeStaticCache() {\n        return this.cdnService.purgeStaticCache();\n    }\n\n    @Post('warm')\n    @UseGuards(SuperAdminGuard)\n    @ApiOperation({ summary: 'Warm CDN cache' })\n    async warmCache(@Body() body: { urls: string[] }) {\n        return this.cdnService.warmCache(body.urls);\n    }\n\n    @Get('url')\n    @ApiOperation({ summary: 'Get CDN URL for path' })\n    getCdnUrl(@Query('path') path: string) {\n        return {\n            original: path,\n            cdnUrl: this.cdnService.getCdnUrl(path),\n        };\n    }\n}\n"],"names":["CdnController","getConfig","cdnService","purgeCache","body","purge","purgeTenantCache","req","user","tenant_id","purgeStaticCache","warmCache","urls","getCdnUrl","path","original","cdnUrl","summary"],"mappings":";;;;+BASaA;;;eAAAA;;;wBATyE;yBACjC;4BAC1B;wBACmB;;;;;;;;;;;;;;;AAMvC,IAAA,AAAMA,gBAAN,MAAMA;IAMTC,YAAY;QACR,OAAO,IAAI,CAACC,UAAU,CAACD,SAAS;IACpC;IAEA,MAGME,WACF,AAAQC,IAAyD,EACnE;QACE,OAAO,IAAI,CAACF,UAAU,CAACG,KAAK,CAACD;IACjC;IAEA,MAEME,iBAAiB,AAAWC,GAAQ,EAAE;QACxC,OAAO,IAAI,CAACL,UAAU,CAACI,gBAAgB,CAACC,IAAIC,IAAI,CAACC,SAAS;IAC9D;IAEA,MAGMC,mBAAmB;QACrB,OAAO,IAAI,CAACR,UAAU,CAACQ,gBAAgB;IAC3C;IAEA,MAGMC,UAAU,AAAQP,IAAwB,EAAE;QAC9C,OAAO,IAAI,CAACF,UAAU,CAACS,SAAS,CAACP,KAAKQ,IAAI;IAC9C;IAIAC,UAAU,AAAeC,IAAY,EAAE;QACnC,OAAO;YACHC,UAAUD;YACVE,QAAQ,IAAI,CAACd,UAAU,CAACW,SAAS,CAACC;QACtC;IACJ;IA7CA,YAAY,AAAiBZ,UAAsB,CAAE;aAAxBA,aAAAA;IAAyB;AA8C1D;;;;;QA1CoBe,SAAS;;;;;;;;;;QAOTA,SAAS;;;;;;;;;;;;QAQTA,SAAS;;;;;;;;;;;;;QAOTA,SAAS;;;;;;;;;;QAOTA,SAAS;;;;;;;;;;;;QAMTA,SAAS"}