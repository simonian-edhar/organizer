{"version":3,"sources":["../../../../src/enterprise/audit/interfaces/worm-audit.interface.ts"],"sourcesContent":["/**\n * WORM (Write Once Read Many) Audit Storage Configuration\n * Provides immutable audit logging for compliance\n */\n\nexport interface WormAuditConfig {\n    enabled: boolean;\n    retentionDays: number;\n    storageType: 's3' | 'database' | 'file';\n    encryptionEnabled: boolean;\n    compressionEnabled: boolean;\n}\n\nexport interface AuditEntry {\n    id: string;\n    tenantId: string;\n    userId?: string;\n    action: AuditActionType;\n    entityType: string;\n    entityId?: string;\n    oldValues?: Record<string, any>;\n    newValues?: Record<string, any>;\n    changedFields?: string[];\n    ipAddress?: string;\n    userAgent?: string;\n    requestId?: string;\n    sessionId?: string;\n    metadata?: Record<string, any>;\n    timestamp: Date;\n    hash: string; // Integrity hash\n    previousHash?: string; // Blockchain-like chaining\n}\n\nexport type AuditActionType =\n    | 'create'\n    | 'update'\n    | 'delete'\n    | 'login'\n    | 'logout'\n    | 'login_failed'\n    | 'permission_change'\n    | 'role_change'\n    | 'password_change'\n    | 'mfa_enabled'\n    | 'mfa_disabled'\n    | 'export'\n    | 'download'\n    | 'share'\n    | 'api_key_create'\n    | 'api_key_revoke'\n    | 'settings_change'\n    | 'subscription_change'\n    | 'user_invite'\n    | 'user_remove';\n\nexport const DEFAULT_WORM_CONFIG: WormAuditConfig = {\n    enabled: true,\n    retentionDays: 2555, // 7 years for legal compliance\n    storageType: 's3',\n    encryptionEnabled: true,\n    compressionEnabled: true,\n};\n\nexport const ENTERPRISE_RETENTION_DAYS = 2555; // 7 years\nexport const STANDARD_RETENTION_DAYS = 365; // 1 year\n"],"names":["DEFAULT_WORM_CONFIG","ENTERPRISE_RETENTION_DAYS","STANDARD_RETENTION_DAYS","enabled","retentionDays","storageType","encryptionEnabled","compressionEnabled"],"mappings":"AAAA;;;CAGC;;;;;;;;;;;QAoDYA;eAAAA;;QAQAC;eAAAA;;QACAC;eAAAA;;;AATN,MAAMF,sBAAuC;IAChDG,SAAS;IACTC,eAAe;IACfC,aAAa;IACbC,mBAAmB;IACnBC,oBAAoB;AACxB;AAEO,MAAMN,4BAA4B,MAAM,UAAU;AAClD,MAAMC,0BAA0B,KAAK,SAAS"}