{"version":3,"sources":["../../../../src/enterprise/performance/controllers/performance.controller.ts"],"sourcesContent":["import { Controller, Get, Post, Delete, Param, Query, UseGuards, Request } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiBearerAuth } from '@nestjs/swagger';\nimport { QueryOptimizationService } from '../services/query-optimization.service';\nimport { JwtAuthGuard, SuperAdminGuard } from '../../../auth/guards';\n\n@ApiTags('Performance')\n@ApiBearerAuth()\n@Controller('v1/performance')\n@UseGuards(JwtAuthGuard, SuperAdminGuard)\nexport class PerformanceController {\n    constructor(private readonly queryOptimizationService: QueryOptimizationService) {}\n\n    @Get('stats')\n    @ApiOperation({ summary: 'Get database performance statistics' })\n    async getStats() {\n        return this.queryOptimizationService.getDatabaseStats();\n    }\n\n    @Get('slow-queries')\n    @ApiOperation({ summary: 'Get slow query logs' })\n    async getSlowQueries(@Query('limit') limit?: number) {\n        return {\n            queries: this.queryOptimizationService.getSlowQueries(limit),\n            summary: this.queryOptimizationService.getPerformanceSummary(),\n        };\n    }\n\n    @Get('index-suggestions/:table')\n    @ApiOperation({ summary: 'Get index suggestions for table' })\n    async getIndexSuggestions(@Param('table') table: string) {\n        return this.queryOptimizationService.getIndexSuggestions(table);\n    }\n\n    @Post('analyze/:table')\n    @ApiOperation({ summary: 'Run VACUUM ANALYZE on table' })\n    async vacuumAnalyze(@Param('table') table: string) {\n        await this.queryOptimizationService.vacuumAnalyze(table);\n        return { success: true, message: `VACUUM ANALYZE completed for ${table}` };\n    }\n\n    @Post('analyze-query')\n    @ApiOperation({ summary: 'Analyze query execution plan' })\n    async analyzeQuery(@Query('query') query: string) {\n        return this.queryOptimizationService.analyzeQueryPlan(query);\n    }\n\n    @Delete('slow-queries')\n    @ApiOperation({ summary: 'Clear slow query logs' })\n    async clearSlowQueries() {\n        this.queryOptimizationService.clearSlowQueryLogs();\n        return { success: true };\n    }\n}\n"],"names":["PerformanceController","getStats","queryOptimizationService","getDatabaseStats","getSlowQueries","limit","queries","summary","getPerformanceSummary","getIndexSuggestions","table","vacuumAnalyze","success","message","analyzeQuery","query","analyzeQueryPlan","clearSlowQueries","clearSlowQueryLogs"],"mappings":";;;;+BASaA;;;eAAAA;;;wBATmE;yBAC3B;0CACZ;wBACK;;;;;;;;;;;;;;;AAMvC,IAAA,AAAMA,wBAAN,MAAMA;IAGT,MAEMC,WAAW;QACb,OAAO,IAAI,CAACC,wBAAwB,CAACC,gBAAgB;IACzD;IAEA,MAEMC,eAAe,AAAgBC,KAAc,EAAE;QACjD,OAAO;YACHC,SAAS,IAAI,CAACJ,wBAAwB,CAACE,cAAc,CAACC;YACtDE,SAAS,IAAI,CAACL,wBAAwB,CAACM,qBAAqB;QAChE;IACJ;IAEA,MAEMC,oBAAoB,AAAgBC,KAAa,EAAE;QACrD,OAAO,IAAI,CAACR,wBAAwB,CAACO,mBAAmB,CAACC;IAC7D;IAEA,MAEMC,cAAc,AAAgBD,KAAa,EAAE;QAC/C,MAAM,IAAI,CAACR,wBAAwB,CAACS,aAAa,CAACD;QAClD,OAAO;YAAEE,SAAS;YAAMC,SAAS,CAAC,6BAA6B,EAAEH,OAAO;QAAC;IAC7E;IAEA,MAEMI,aAAa,AAAgBC,KAAa,EAAE;QAC9C,OAAO,IAAI,CAACb,wBAAwB,CAACc,gBAAgB,CAACD;IAC1D;IAEA,MAEME,mBAAmB;QACrB,IAAI,CAACf,wBAAwB,CAACgB,kBAAkB;QAChD,OAAO;YAAEN,SAAS;QAAK;IAC3B;IAzCA,YAAY,AAAiBV,wBAAkD,CAAE;aAApDA,2BAAAA;IAAqD;AA0CtF;;;;QAvCoBK,SAAS;;;;;;;;;QAMTA,SAAS;;;;;;;;;;;;QASTA,SAAS;;;;;;;;;;;;QAMTA,SAAS;;;;;;;;;;;;QAOTA,SAAS;;;;;;;;;;;;QAMTA,SAAS"}