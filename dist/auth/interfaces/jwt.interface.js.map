{"version":3,"sources":["../../../src/auth/interfaces/jwt.interface.ts"],"sourcesContent":["/**\n * JWT Payload interface\n */\nexport interface JwtPayload {\n    user_id: string;\n    tenant_id: string;\n    role: string;\n    subscription_plan: string;\n    email: string;\n    jti?: string; // JWT ID for revocation\n    iat?: number; // Issued at\n    exp?: number; // Expires at\n}\n\n/**\n * Refresh Token Payload\n */\nexport interface RefreshTokenPayload {\n    user_id: string;\n    tenant_id: string;\n    token_id: string;\n    device_id: string;\n    iat?: number;\n    exp?: number;\n}\n\n/**\n * Authenticated Request Interface\n */\nexport interface AuthenticatedRequest extends Request {\n    user: JwtPayload;\n    deviceId?: string;\n}\n\n/**\n * Security Configuration\n */\nexport const SecurityConfig = {\n    // JWT\n    JWT_ACCESS_TOKEN_EXPIRY: '15m', // 15 minutes\n    JWT_REFRESH_TOKEN_EXPIRY: '7d', // 7 days\n    JWT_ALGORITHM: 'HS256', // Use RS256 for enterprise\n\n    // Password\n    PASSWORD_MIN_LENGTH: 8,\n    PASSWORD_MAX_LENGTH: 128,\n    PASSWORD_SALT_ROUNDS: 12,\n    PASSWORD_RESET_EXPIRY: '1h',\n    PASSWORD_MAX_HISTORY: 5,\n\n    // Rate Limiting\n    RATE_LIMIT_WINDOW: 15 * 60 * 1000, // 15 minutes\n    RATE_LIMIT_MAX_ATTEMPTS: 5,\n    RATE_LIMIT_BAN_DURATION: 15 * 60 * 1000, // 15 minutes\n\n    // MFA\n    MFA_TOTP_DIGITS: 6,\n    MFA_TOTP_PERIOD: 30, // seconds\n    MFA_TOTP_WINDOW: 2, // Â±2 periods\n\n    // Session\n    MAX_REFRESH_TOKENS_PER_USER: 5,\n    MAX_CONCURRENT_SESSIONS: 10,\n\n    // Lockout\n    MAX_FAILED_LOGIN_ATTEMPTS: 5,\n    ACCOUNT_LOCKOUT_DURATION: 30 * 60 * 1000, // 30 minutes\n\n    // Encryption\n    ENCRYPTION_KEY: process.env.ENCRYPTION_KEY,\n    ENCRYPTION_ALGORITHM: 'aes-256-gcb',\n};\n"],"names":["SecurityConfig","JWT_ACCESS_TOKEN_EXPIRY","JWT_REFRESH_TOKEN_EXPIRY","JWT_ALGORITHM","PASSWORD_MIN_LENGTH","PASSWORD_MAX_LENGTH","PASSWORD_SALT_ROUNDS","PASSWORD_RESET_EXPIRY","PASSWORD_MAX_HISTORY","RATE_LIMIT_WINDOW","RATE_LIMIT_MAX_ATTEMPTS","RATE_LIMIT_BAN_DURATION","MFA_TOTP_DIGITS","MFA_TOTP_PERIOD","MFA_TOTP_WINDOW","MAX_REFRESH_TOKENS_PER_USER","MAX_CONCURRENT_SESSIONS","MAX_FAILED_LOGIN_ATTEMPTS","ACCOUNT_LOCKOUT_DURATION","ENCRYPTION_KEY","process","env","ENCRYPTION_ALGORITHM"],"mappings":"AAAA;;CAEC;;;;+BAmCYA;;;eAAAA;;;AAAN,MAAMA,iBAAiB;IAC1B,MAAM;IACNC,yBAAyB;IACzBC,0BAA0B;IAC1BC,eAAe;IAEf,WAAW;IACXC,qBAAqB;IACrBC,qBAAqB;IACrBC,sBAAsB;IACtBC,uBAAuB;IACvBC,sBAAsB;IAEtB,gBAAgB;IAChBC,mBAAmB,KAAK,KAAK;IAC7BC,yBAAyB;IACzBC,yBAAyB,KAAK,KAAK;IAEnC,MAAM;IACNC,iBAAiB;IACjBC,iBAAiB;IACjBC,iBAAiB;IAEjB,UAAU;IACVC,6BAA6B;IAC7BC,yBAAyB;IAEzB,UAAU;IACVC,2BAA2B;IAC3BC,0BAA0B,KAAK,KAAK;IAEpC,aAAa;IACbC,gBAAgBC,QAAQC,GAAG,CAACF,cAAc;IAC1CG,sBAAsB;AAC1B"}