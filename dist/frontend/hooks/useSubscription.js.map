{"version":3,"sources":["../../../src/frontend/hooks/useSubscription.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { subscriptionService } from '../services/subscription.service';\nimport type { Subscription, SubscriptionPlan, SubscriptionFeatures } from '../types/subscription.types';\n\n/**\n * Use Subscription Hook\n */\nexport const useSubscription = () => {\n    const [subscription, setSubscription] = useState<Subscription | null>(null);\n    const [isLoading, setIsLoading] = useState(false);\n    const [error, setError] = useState<string | null>(null);\n\n    /**\n     * Load subscription\n     */\n    const loadSubscription = useCallback(async (): Promise<void> => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const data = await subscriptionService.getSubscription();\n            setSubscription(data);\n        } catch (error: any) {\n            setError(error.response?.data?.message || 'Не вдалося завантажити підписку');\n        } finally {\n            setIsLoading(false);\n        }\n    }, []);\n\n    /**\n     * Upgrade plan\n     */\n    const upgradePlan = useCallback(async (plan: SubscriptionPlan): Promise<{ checkoutUrl: string }> => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            const result = await subscriptionService.upgradePlan(plan);\n            return result;\n        } catch (error: any) {\n            setError(error.response?.data?.message || 'Не вдалося оновити план');\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, []);\n\n    /**\n     * Cancel subscription\n     */\n    const cancelSubscription = useCallback(async (): Promise<void> => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            await subscriptionService.cancelSubscription();\n            await loadSubscription();\n        } catch (error: any) {\n            setError(error.response?.data?.message || 'Не вдалося скасувати підписку');\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [loadSubscription]);\n\n    /**\n     * Resume subscription\n     */\n    const resumeSubscription = useCallback(async (): Promise<void> => {\n        setIsLoading(true);\n        setError(null);\n\n        try {\n            await subscriptionService.resumeSubscription();\n            await loadSubscription();\n        } catch (error: any) {\n            setError(error.response?.data?.message || 'Не вдалося відновити підписку');\n            throw error;\n        } finally {\n            setIsLoading(false);\n        }\n    }, [loadSubscription]);\n\n    /**\n     * Check if plan has feature\n     */\n    const hasFeature = useCallback((feature: keyof SubscriptionFeatures): boolean => {\n        if (!subscription) return false;\n        return subscriptionService.hasFeature(subscription.plan, feature);\n    }, [subscription]);\n\n    /**\n     * Get plan limit\n     */\n    const getPlanLimit = useCallback((limit: keyof SubscriptionFeatures): any => {\n        if (!subscription) return null;\n        return subscriptionService.getPlanLimit(subscription.plan, limit);\n    }, [subscription]);\n\n    /**\n     * Get current plan\n     */\n    const getPlan = useCallback((): SubscriptionPlan | null => {\n        return subscription?.plan || null;\n    }, [subscription]);\n\n    /**\n     * Get subscription status\n     */\n    const getStatus = useCallback((): string | null => {\n        return subscription?.status || null;\n    }, [subscription]);\n\n    /**\n     * Load on first render\n     */\n    useEffect(() => {\n        loadSubscription();\n    }, [loadSubscription]);\n\n    return {\n        subscription,\n        isLoading,\n        error,\n        loadSubscription,\n        upgradePlan,\n        cancelSubscription,\n        resumeSubscription,\n        hasFeature,\n        getPlanLimit,\n        getPlan,\n        getStatus,\n    };\n};\n"],"names":["useSubscription","subscription","setSubscription","useState","isLoading","setIsLoading","error","setError","loadSubscription","useCallback","data","subscriptionService","getSubscription","response","message","upgradePlan","plan","result","cancelSubscription","resumeSubscription","hasFeature","feature","getPlanLimit","limit","getPlan","getStatus","status","useEffect"],"mappings":";;;;+BAOaA;;;eAAAA;;;uBAPoC;qCACb;AAM7B,MAAMA,kBAAkB;IAC3B,MAAM,CAACC,cAAcC,gBAAgB,GAAGC,IAAAA,eAAQ,EAAsB;IACtE,MAAM,CAACC,WAAWC,aAAa,GAAGF,IAAAA,eAAQ,EAAC;IAC3C,MAAM,CAACG,OAAOC,SAAS,GAAGJ,IAAAA,eAAQ,EAAgB;IAElD;;KAEC,GACD,MAAMK,mBAAmBC,IAAAA,kBAAW,EAAC;QACjCJ,aAAa;QACbE,SAAS;QAET,IAAI;YACA,MAAMG,OAAO,MAAMC,wCAAmB,CAACC,eAAe;YACtDV,gBAAgBQ;QACpB,EAAE,OAAOJ,OAAY;YACjBC,SAASD,MAAMO,QAAQ,EAAEH,MAAMI,WAAW;QAC9C,SAAU;YACNT,aAAa;QACjB;IACJ,GAAG,EAAE;IAEL;;KAEC,GACD,MAAMU,cAAcN,IAAAA,kBAAW,EAAC,OAAOO;QACnCX,aAAa;QACbE,SAAS;QAET,IAAI;YACA,MAAMU,SAAS,MAAMN,wCAAmB,CAACI,WAAW,CAACC;YACrD,OAAOC;QACX,EAAE,OAAOX,OAAY;YACjBC,SAASD,MAAMO,QAAQ,EAAEH,MAAMI,WAAW;YAC1C,MAAMR;QACV,SAAU;YACND,aAAa;QACjB;IACJ,GAAG,EAAE;IAEL;;KAEC,GACD,MAAMa,qBAAqBT,IAAAA,kBAAW,EAAC;QACnCJ,aAAa;QACbE,SAAS;QAET,IAAI;YACA,MAAMI,wCAAmB,CAACO,kBAAkB;YAC5C,MAAMV;QACV,EAAE,OAAOF,OAAY;YACjBC,SAASD,MAAMO,QAAQ,EAAEH,MAAMI,WAAW;YAC1C,MAAMR;QACV,SAAU;YACND,aAAa;QACjB;IACJ,GAAG;QAACG;KAAiB;IAErB;;KAEC,GACD,MAAMW,qBAAqBV,IAAAA,kBAAW,EAAC;QACnCJ,aAAa;QACbE,SAAS;QAET,IAAI;YACA,MAAMI,wCAAmB,CAACQ,kBAAkB;YAC5C,MAAMX;QACV,EAAE,OAAOF,OAAY;YACjBC,SAASD,MAAMO,QAAQ,EAAEH,MAAMI,WAAW;YAC1C,MAAMR;QACV,SAAU;YACND,aAAa;QACjB;IACJ,GAAG;QAACG;KAAiB;IAErB;;KAEC,GACD,MAAMY,aAAaX,IAAAA,kBAAW,EAAC,CAACY;QAC5B,IAAI,CAACpB,cAAc,OAAO;QAC1B,OAAOU,wCAAmB,CAACS,UAAU,CAACnB,aAAae,IAAI,EAAEK;IAC7D,GAAG;QAACpB;KAAa;IAEjB;;KAEC,GACD,MAAMqB,eAAeb,IAAAA,kBAAW,EAAC,CAACc;QAC9B,IAAI,CAACtB,cAAc,OAAO;QAC1B,OAAOU,wCAAmB,CAACW,YAAY,CAACrB,aAAae,IAAI,EAAEO;IAC/D,GAAG;QAACtB;KAAa;IAEjB;;KAEC,GACD,MAAMuB,UAAUf,IAAAA,kBAAW,EAAC;QACxB,OAAOR,cAAce,QAAQ;IACjC,GAAG;QAACf;KAAa;IAEjB;;KAEC,GACD,MAAMwB,YAAYhB,IAAAA,kBAAW,EAAC;QAC1B,OAAOR,cAAcyB,UAAU;IACnC,GAAG;QAACzB;KAAa;IAEjB;;KAEC,GACD0B,IAAAA,gBAAS,EAAC;QACNnB;IACJ,GAAG;QAACA;KAAiB;IAErB,OAAO;QACHP;QACAG;QACAE;QACAE;QACAO;QACAG;QACAC;QACAC;QACAE;QACAE;QACAC;IACJ;AACJ"}