{"version":3,"sources":["../../../src/frontend/hooks/usePermissions.ts"],"sourcesContent":["import { useCallback } from 'react';\nimport { useSelector } from 'react-redux';\nimport { RootState } from '../store';\nimport type { UserRole, SubscriptionPlan, SubscriptionFeatures } from '../types/subscription.types';\nimport { PLAN_LIMITS } from '../types/subscription.types';\n\n/**\n * Use Permissions Hook\n */\nexport const usePermissions = () => {\n    const user = useSelector((state: RootState) => state.auth.user);\n    const organization = useSelector((state: RootState) => state.auth.organization);\n\n    /**\n     * Check if user has role\n     */\n    const hasRole = useCallback((roles: UserRole[]): boolean => {\n        if (!user) return false;\n        return roles.includes(user.role as UserRole);\n    }, [user]);\n\n    /**\n     * Check if user is organization owner\n     */\n    const isOwner = useCallback((): boolean => {\n        return hasRole(['organization_owner']);\n    }, [hasRole]);\n\n    /**\n     * Check if user is admin\n     */\n    const isAdmin = useCallback((): boolean => {\n        return hasRole(['organization_owner', 'organization_admin']);\n    }, [hasRole]);\n\n    /**\n     * Check if user is lawyer\n     */\n    const isLawyer = useCallback((): boolean => {\n        return hasRole(['lawyer']);\n    }, [hasRole]);\n\n    /**\n     * Check if user is assistant\n     */\n    const isAssistant = useCallback((): boolean => {\n        return hasRole(['assistant']);\n    }, [hasRole]);\n\n    /**\n     * Check if user is accountant\n     */\n    const isAccountant = useCallback((): boolean => {\n        return hasRole(['accountant']);\n    }, [hasRole]);\n\n    /**\n     * Get subscription plan\n     */\n    const getPlan = useCallback((): SubscriptionPlan | null => {\n        return organization?.subscriptionPlan || null;\n    }, [organization]);\n\n    /**\n     * Check if plan has feature\n     */\n    const hasFeature = useCallback((feature: keyof SubscriptionFeatures): boolean => {\n        const plan = getPlan();\n        if (!plan) return false;\n        return !!PLAN_LIMITS[plan]?.[feature];\n    }, [getPlan]);\n\n    /**\n     * Check if can manage users\n     */\n    const canManageUsers = useCallback((): boolean => {\n        return isAdmin();\n    }, [isAdmin]);\n\n    /**\n     * Check if can manage billing\n     */\n    const canManageBilling = useCallback((): boolean => {\n        return isOwner();\n    }, [isOwner]);\n\n    /**\n     * Check if can access advanced audit\n     */\n    const canAccessAdvancedAudit = useCallback((): boolean => {\n        return hasFeature('advancedAudit') && isOwner();\n    }, [hasFeature, isOwner]);\n\n    /**\n     * Check if can manage settings\n     */\n    const canManageSettings = useCallback((): boolean => {\n        return isAdmin();\n    }, [isAdmin]);\n\n    /**\n     * Check if can create cases\n     */\n    const canCreateCases = useCallback((): boolean => {\n        return hasRole(['organization_owner', 'organization_admin', 'lawyer']);\n    }, [hasRole]);\n\n    /**\n     * Check if can view cases\n     */\n    const canViewCases = useCallback((): boolean => {\n        return hasRole(['organization_owner', 'organization_admin', 'lawyer', 'assistant']);\n    }, [hasRole]);\n\n    /**\n     * Check if can manage documents\n     */\n    const canManageDocuments = useCallback((): boolean => {\n        return hasRole(['organization_owner', 'organization_admin', 'lawyer', 'assistant']);\n    }, [hasRole]);\n\n    /**\n     * Check if can view billing\n     */\n    const canViewBilling = useCallback((): boolean => {\n        return isAdmin() || isAccountant();\n    }, [isAdmin, isAccountant]);\n\n    /**\n     * Check if can invite users\n     */\n    const canInviteUsers = useCallback((): boolean => {\n        const plan = getPlan();\n        if (!plan) return false;\n        const maxUsers = PLAN_LIMITS[plan]?.maxUsers || 0;\n        if (maxUsers === -1) return isAdmin(); // Unlimited\n        // TODO: Get current user count from API\n        return isAdmin(); // Simplified for now\n    }, [isAdmin, getPlan]);\n\n    return {\n        user,\n        organization,\n        hasRole,\n        isOwner,\n        isAdmin,\n        isLawyer,\n        isAssistant,\n        isAccountant,\n        getPlan,\n        hasFeature,\n        canManageUsers,\n        canManageBilling,\n        canAccessAdvancedAudit,\n        canManageSettings,\n        canCreateCases,\n        canViewCases,\n        canManageDocuments,\n        canViewBilling,\n        canInviteUsers,\n    };\n};\n"],"names":["usePermissions","user","useSelector","state","auth","organization","hasRole","useCallback","roles","includes","role","isOwner","isAdmin","isLawyer","isAssistant","isAccountant","getPlan","subscriptionPlan","hasFeature","feature","plan","PLAN_LIMITS","canManageUsers","canManageBilling","canAccessAdvancedAudit","canManageSettings","canCreateCases","canViewCases","canManageDocuments","canViewBilling","canInviteUsers","maxUsers"],"mappings":"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"}