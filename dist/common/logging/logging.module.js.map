{"version":3,"sources":["../../../src/common/logging/logging.module.ts"],"sourcesContent":["import { Module, DynamicModule, Provider } from '@nestjs/common';\nimport { WinstonModule } from 'nest-winston';\nimport { ConfigModule, ConfigService } from '@nestjs/config';\nimport * as winston from 'winston';\nimport { createLoggerConfig } from './logger.config';\nimport { LoggingService } from './logging.service';\n\n/**\n * Logging module configuration options\n */\nexport interface LoggingModuleOptions {\n  enableRequestLogging?: boolean;\n  enableMethodLogging?: boolean;\n  enablePerformanceLogging?: boolean;\n  performanceThreshold?: number;\n}\n\n/**\n * Logging module interface for dynamic module\n */\nexport interface LoggingModuleAsyncOptions extends LoggingModuleOptions {\n  imports?: any[];\n  inject?: any[];\n  useFactory?: (...args: any[]) => Promise<LoggingModuleOptions> | LoggingModuleOptions;\n}\n\n/**\n * Logging module provider token\n */\nexport const LOGGING_OPTIONS = 'LOGGING_OPTIONS';\n\n/**\n * Logging Module\n * Provides structured logging with context support\n */\n@Module({})\nexport class LoggingModule {\n  /**\n   * Register logging module synchronously\n   */\n  static register(options: LoggingModuleOptions = {}): DynamicModule {\n    const optionsProvider: Provider = {\n      provide: LOGGING_OPTIONS,\n      useValue: options,\n    };\n\n    return {\n      module: LoggingModule,\n      imports: [\n        ConfigModule,\n        WinstonModule.forRootAsync({\n          imports: [ConfigModule],\n          inject: [ConfigService],\n          useFactory: (configService: ConfigService) => createLoggerConfig(configService),\n        }),\n      ],\n      providers: [optionsProvider, LoggingService],\n      exports: [LoggingService],\n      global: true,\n    };\n  }\n\n  /**\n   * Register logging module asynchronously\n   */\n  static registerAsync(options: LoggingModuleAsyncOptions): DynamicModule {\n    const asyncOptionsProvider: Provider = {\n      provide: LOGGING_OPTIONS,\n      useFactory: options.useFactory,\n      inject: options.inject || [],\n    };\n\n    return {\n      module: LoggingModule,\n      imports: [\n        ...(options.imports || []),\n        WinstonModule.forRootAsync({\n          inject: [ConfigService],\n          useFactory: (configService: ConfigService) => {\n            return createLoggerConfig(configService);\n          },\n        }),\n      ],\n      providers: [asyncOptionsProvider, LoggingService],\n      exports: [LoggingService],\n      global: true,\n    };\n  }\n}\n"],"names":["LOGGING_OPTIONS","LoggingModule","register","options","optionsProvider","provide","useValue","module","imports","ConfigModule","WinstonModule","forRootAsync","inject","ConfigService","useFactory","configService","createLoggerConfig","providers","LoggingService","exports","global","registerAsync","asyncOptionsProvider"],"mappings":";;;;;;;;;;;QA6BaA;eAAAA;;QAOAC;eAAAA;;;wBApCmC;6BAClB;wBACc;8BAET;gCACJ;;;;;;;AAwBxB,MAAMD,kBAAkB;AAOxB,IAAA,AAAMC,gBAAN,MAAMA;IACX;;GAEC,GACD,OAAOC,SAASC,UAAgC,CAAC,CAAC,EAAiB;QACjE,MAAMC,kBAA4B;YAChCC,SAASL;YACTM,UAAUH;QACZ;QAEA,OAAO;YACLI,QAAQN;YACRO,SAAS;gBACPC,oBAAY;gBACZC,0BAAa,CAACC,YAAY,CAAC;oBACzBH,SAAS;wBAACC,oBAAY;qBAAC;oBACvBG,QAAQ;wBAACC,qBAAa;qBAAC;oBACvBC,YAAY,CAACC,gBAAiCC,IAAAA,gCAAkB,EAACD;gBACnE;aACD;YACDE,WAAW;gBAACb;gBAAiBc,8BAAc;aAAC;YAC5CC,SAAS;gBAACD,8BAAc;aAAC;YACzBE,QAAQ;QACV;IACF;IAEA;;GAEC,GACD,OAAOC,cAAclB,OAAkC,EAAiB;QACtE,MAAMmB,uBAAiC;YACrCjB,SAASL;YACTc,YAAYX,QAAQW,UAAU;YAC9BF,QAAQT,QAAQS,MAAM,IAAI,EAAE;QAC9B;QAEA,OAAO;YACLL,QAAQN;YACRO,SAAS;mBACHL,QAAQK,OAAO,IAAI,EAAE;gBACzBE,0BAAa,CAACC,YAAY,CAAC;oBACzBC,QAAQ;wBAACC,qBAAa;qBAAC;oBACvBC,YAAY,CAACC;wBACX,OAAOC,IAAAA,gCAAkB,EAACD;oBAC5B;gBACF;aACD;YACDE,WAAW;gBAACK;gBAAsBJ,8BAAc;aAAC;YACjDC,SAAS;gBAACD,8BAAc;aAAC;YACzBE,QAAQ;QACV;IACF;AACF"}