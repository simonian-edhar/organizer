{"version":3,"sources":["../../../src/clients/controllers/clients.controller.ts"],"sourcesContent":["import {\n    Controller,\n    Get,\n    Post,\n    Put,\n    Patch,\n    Delete,\n    Body,\n    Param,\n    Query,\n    UseGuards,\n    HttpCode,\n    HttpStatus,\nReq, } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiResponse, ApiBearerAuth, ApiParam, ApiQuery } from '@nestjs/swagger';\nimport { ClientService } from '../services/client.service';\nimport { CreateClientDto, UpdateClientDto, ClientFiltersDto, BulkImportClientsDto } from '../dto/client.dto';\nimport { JwtAuthGuard } from '../../auth/guards';\nimport { TenantGuard, RbacGuard } from '../../auth/guards';\n\n/**\n * Clients Controller\n */\n@ApiTags('Clients')\n@Controller('clients')\n@UseGuards(JwtAuthGuard, TenantGuard)\n@ApiBearerAuth()\nexport class ClientsController {\n    constructor(private readonly clientService: ClientService) {}\n\n    @Get()\n    @ApiOperation({ summary: 'Get all clients' })\n    @ApiResponse({ status: 200, description: 'Clients retrieved' })\n    async findAll(\n        @Query() filters: ClientFiltersDto,\n        @Req() req: any\n    ): Promise<{ data: any[]; total: number; page: number; limit: number }> {\n        const tenantId = req.user?.tenant_id;\n        return this.clientService.findAll(tenantId, filters);\n    }\n\n    @Get('statistics')\n    @ApiOperation({ summary: 'Get client statistics' })\n    @ApiResponse({ status: 200, description: 'Statistics retrieved' })\n    async getStatistics(@Req() req: any): Promise<any> {\n        const tenantId = req.user?.tenant_id;\n        return this.clientService.getStatistics(tenantId);\n    }\n\n    @Get(':id')\n    @ApiOperation({ summary: 'Get client by ID' })\n    @ApiResponse({ status: 200, description: 'Client retrieved' })\n    async findById(@Param('id') id: string, @Req() req: any): Promise<any> {\n        const tenantId = req.user?.tenant_id;\n        return this.clientService.findById(tenantId, id);\n    }\n\n    @Post()\n    @UseGuards(RbacGuard)\n    @ApiOperation({ summary: 'Create new client' })\n    @ApiResponse({ status: 201, description: 'Client created' })\n    async create(@Body() dto: CreateClientDto, @Req() req: any): Promise<any> {\n        const tenantId = req.user?.tenant_id;\n        const userId = req.user?.user_id;\n        return this.clientService.create(tenantId, userId, dto);\n    }\n\n    @Post('import')\n    @UseGuards(RbacGuard)\n    @ApiOperation({ summary: 'Bulk import clients' })\n    @ApiResponse({ status: 201, description: 'Clients imported' })\n    async bulkImport(\n        @Body() dto: BulkImportClientsDto,\n        @Req() req: any\n    ): Promise<{ success: number; failed: number; errors: any[] }> {\n        const tenantId = req.user?.tenant_id;\n        const userId = req.user?.user_id;\n        return this.clientService.bulkImport(tenantId, userId, dto.clients);\n    }\n\n    @Put(':id')\n    @UseGuards(RbacGuard)\n    @ApiOperation({ summary: 'Update client' })\n    @ApiResponse({ status: 200, description: 'Client updated' })\n    async update(\n        @Param('id') id: string,\n        @Body() dto: UpdateClientDto,\n        @Req() req: any\n    ): Promise<any> {\n        const tenantId = req.user?.tenant_id;\n        const userId = req.user?.user_id;\n        return this.clientService.update(tenantId, id, userId, dto);\n    }\n\n    @Patch(':id')\n    @UseGuards(RbacGuard)\n    @ApiOperation({ summary: 'Patch client (partial update)' })\n    @ApiResponse({ status: 200, description: 'Client patched' })\n    async patch(\n        @Param('id') id: string,\n        @Body() dto: Partial<UpdateClientDto>,\n        @Req() req: any\n    ): Promise<any> {\n        const tenantId = req.user?.tenant_id;\n        const userId = req.user?.user_id;\n        return this.clientService.update(tenantId, id, userId, dto as UpdateClientDto);\n    }\n\n    @Delete(':id')\n    @UseGuards(RbacGuard)\n    @HttpCode(HttpStatus.NO_CONTENT)\n    @ApiOperation({ summary: 'Delete client' })\n    @ApiResponse({ status: 204, description: 'Client deleted' })\n    async delete(@Param('id') id: string, @Req() req: any): Promise<void> {\n        const tenantId = req.user?.tenant_id;\n        const userId = req.user?.user_id;\n        return this.clientService.delete(tenantId, id, userId);\n    }\n\n    @Post(':id/restore')\n    @UseGuards(RbacGuard)\n    @ApiOperation({ summary: 'Restore deleted client' })\n    @ApiResponse({ status: 200, description: 'Client restored' })\n    async restore(@Param('id') id: string, @Req() req: any): Promise<any> {\n        const tenantId = req.user?.tenant_id;\n        const userId = req.user?.user_id;\n        return this.clientService.restore(tenantId, id, userId);\n    }\n}\n"],"names":["ClientsController","findAll","filters","req","tenantId","user","tenant_id","clientService","getStatistics","findById","id","create","dto","userId","user_id","bulkImport","clients","update","patch","delete","restore","summary","status","description","NO_CONTENT"],"mappings":"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"}