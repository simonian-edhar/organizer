{"version":3,"sources":["../../../src/database/entities/Subscription.entity.ts"],"sourcesContent":["import { Entity, PrimaryGeneratedColumn, Column, CreateDateColumn, UpdateDateColumn, Index, ManyToOne, JoinColumn } from 'typeorm';\nimport { SubscriptionPlan, SubscriptionStatus, SubscriptionProvider } from './enums/subscription.enum';\n\n@Entity('subscriptions')\n@Index('idx_subscriptions_tenant_id', ['tenantId'])\n@Index('idx_subscriptions_external_id', ['externalId'])\n@Index('idx_subscriptions_status', ['status'])\n@Index('idx_subscriptions_plan', ['plan'])\nexport class Subscription {\n    @PrimaryGeneratedColumn('uuid')\n    id: string;\n\n    @Column({ name: 'tenant_id', type: 'uuid' })\n    tenantId: string;\n\n    // Provider info\n    @Column({\n        type: 'varchar',\n    })\n    provider: SubscriptionProvider;\n\n    @Column({ name: 'external_id', type: 'varchar', length: 255, nullable: true })\n    externalId: string;\n\n    @Column({ name: 'subscription_external_id', type: 'varchar', length: 255, nullable: true })\n    subscriptionExternalId: string;\n\n    // Plan info\n    @Column({\n        type: 'varchar',\n    })\n    plan: SubscriptionPlan;\n\n    @Column({\n        type: 'varchar',\n    })\n    status: SubscriptionStatus;\n\n    // Trial\n    @Column({ name: 'trial_start_at', type: 'datetime', nullable: true })\n    trialStartAt: Date;\n\n    @Column({ name: 'trial_end_at', type: 'datetime', nullable: true })\n    trialEndAt: Date;\n\n    // Billing\n    @Column({ name: 'current_period_start_at', type: 'datetime', nullable: true })\n    currentPeriodStartAt: Date;\n\n    @Column({ name: 'current_period_end_at', type: 'datetime', nullable: true })\n    currentPeriodEndAt: Date;\n\n    @Column({ name: 'cancel_at_period_end', type: 'boolean', default: false })\n    cancelAtPeriodEnd: boolean;\n\n    @Column({ name: 'canceled_at', type: 'datetime', nullable: true })\n    canceledAt: Date;\n\n    // Amounts (in cents)\n    @Column({ name: 'amount_cents', type: 'int', nullable: true })\n    amountCents: number;\n\n    @Column({ type: 'varchar', length: 3, default: 'UAH' })\n    currency: string;\n\n    // Webhooks\n    @Column({ name: 'latest_webhook_event_id', type: 'varchar', length: 255, nullable: true })\n    latestWebhookEventId: string;\n\n    @Column({ name: 'last_synced_at', type: 'datetime', nullable: true })\n    lastSyncedAt: Date;\n\n    // Metadata\n    @Column({ type: 'json' })\n    metadata: Record<string, any>;\n\n    // Timestamps\n    @CreateDateColumn({ name: 'created_at', type: 'datetime' })\n    createdAt: Date;\n\n    @UpdateDateColumn({ name: 'updated_at', type: 'datetime' })\n    updatedAt: Date;\n\n    // Relations\n    @ManyToOne(() => require('./Organization.entity').Organization, { onDelete: 'CASCADE' })\n    @JoinColumn({ name: 'tenant_id' })\n    organization: any;\n}\n"],"names":["Subscription","name","type","length","nullable","default","require","Organization","onDelete"],"mappings":";;;;+BAQaA;;;eAAAA;;;yBAR4G;kCAC9C;;;;;;;;;;AAOpE,IAAA,AAAMA,eAAN,MAAMA;AA+Eb;;;;;;;QA3EcC,MAAM;QAAaC,MAAM;;;;;;QAK/BA,MAAM;;;;;;QAIAD,MAAM;QAAeC,MAAM;QAAWC,QAAQ;QAAKC,UAAU;;;;;;QAG7DH,MAAM;QAA4BC,MAAM;QAAWC,QAAQ;QAAKC,UAAU;;;;;;QAKhFF,MAAM;;;;;;QAKNA,MAAM;;;;;;QAKAD,MAAM;QAAkBC,MAAM;QAAYE,UAAU;;;;;;QAGpDH,MAAM;QAAgBC,MAAM;QAAYE,UAAU;;;;;;QAIlDH,MAAM;QAA2BC,MAAM;QAAYE,UAAU;;;;;;QAG7DH,MAAM;QAAyBC,MAAM;QAAYE,UAAU;;;;;;QAG3DH,MAAM;QAAwBC,MAAM;QAAWG,SAAS;;;;;;QAGxDJ,MAAM;QAAeC,MAAM;QAAYE,UAAU;;;;;;QAIjDH,MAAM;QAAgBC,MAAM;QAAOE,UAAU;;;;;;QAG7CF,MAAM;QAAWC,QAAQ;QAAGE,SAAS;;;;;;QAIrCJ,MAAM;QAA2BC,MAAM;QAAWC,QAAQ;QAAKC,UAAU;;;;;;QAGzEH,MAAM;QAAkBC,MAAM;QAAYE,UAAU;;;;;;QAIpDF,MAAM;;;;;;QAIID,MAAM;QAAcC,MAAM;;;;;;QAG1BD,MAAM;QAAcC,MAAM;;;;;gCAI7BI,QAAQ,yBAAyBC,YAAY;QAAIC,UAAU;;;QAC9DP,MAAM;;;;;;;QAjFe;;;QACE;;;QACL;;;QACF"}