{"version":3,"sources":["../../../src/database/entities/AuditLog.entity.ts"],"sourcesContent":["import { Entity, PrimaryGeneratedColumn, Column, CreateDateColumn, Index, ManyToOne, JoinColumn } from 'typeorm';\nimport { AuditAction } from './enums/subscription.enum';\nimport { User } from './User.entity';\nimport { Organization } from './Organization.entity';\n\n@Entity('audit_logs')\n@Index('idx_audit_logs_tenant_id', ['tenantId'])\n@Index('idx_audit_logs_user_id', ['userId'])\n@Index('idx_audit_logs_action', ['action'])\n@Index('idx_audit_logs_entity_type', ['entityType'])\n@Index('idx_audit_logs_entity_id', ['entityId'])\n@Index('idx_audit_logs_created_at', ['createdAt'])\n@Index('idx_audit_logs_tenant_created', ['tenantId', 'createdAt'])\nexport class AuditLog {\n    @PrimaryGeneratedColumn('uuid')\n    id: string;\n\n    @Column({ name: 'tenant_id', type: 'uuid' })\n    tenantId: string;\n\n    @Column({ name: 'user_id', type: 'uuid', nullable: true })\n    userId: string;\n\n    @Column({\n        type: 'varchar',\n    })\n    action: AuditAction;\n\n    @Column({ name: 'entity_type', type: 'varchar', length: 100 })\n    entityType: string;\n\n    @Column({ name: 'entity_id', type: 'uuid', nullable: true })\n    entityId: string;\n\n    // Change tracking\n    @Column({ name: 'old_values', type: 'json', nullable: true })\n    oldValues: Record<string, any>;\n\n    @Column({ name: 'new_values', type: 'json', nullable: true })\n    newValues: Record<string, any>;\n\n    @Column({ name: 'changed_fields', type: 'json', nullable: true })\n    changedFields: string[];\n\n    // Request info\n    @Column({ name: 'ip_address', type: 'varchar', length: 45, nullable: true })\n    ipAddress: string;\n\n    @Column({ name: 'user_agent', type: 'text', nullable: true })\n    userAgent: string;\n\n    @Column({ name: 'request_id', type: 'varchar', length: 100, nullable: true })\n    requestId: string;\n\n    // Metadata\n    @Column({ type: 'json' })\n    metadata: Record<string, any>;\n\n    // Timestamps\n    @CreateDateColumn({ name: 'created_at', type: 'datetime' })\n    createdAt: Date;\n\n    // Relations\n    @ManyToOne(() => Organization, { onDelete: 'CASCADE' })\n    @JoinColumn({ name: 'tenant_id' })\n    organization: Organization;\n\n    @ManyToOne(() => User)\n    @JoinColumn({ name: 'user_id' })\n    user: User;\n}\n"],"names":["AuditLog","name","type","nullable","length","Organization","onDelete","User"],"mappings":";;;;+BAaaA;;;eAAAA;;;yBAb0F;kCAC3E;4BACP;oCACQ;;;;;;;;;;AAUtB,IAAA,AAAMA,WAAN,MAAMA;AAyDb;;;;;;;QArDcC,MAAM;QAAaC,MAAM;;;;;;QAGzBD,MAAM;QAAWC,MAAM;QAAQC,UAAU;;;;;;QAI/CD,MAAM;;;;;;QAIAD,MAAM;QAAeC,MAAM;QAAWE,QAAQ;;;;;;QAG9CH,MAAM;QAAaC,MAAM;QAAQC,UAAU;;;;;;QAI3CF,MAAM;QAAcC,MAAM;QAAQC,UAAU;;;;;;QAG5CF,MAAM;QAAcC,MAAM;QAAQC,UAAU;;;;;;QAG5CF,MAAM;QAAkBC,MAAM;QAAQC,UAAU;;;;;;QAIhDF,MAAM;QAAcC,MAAM;QAAWE,QAAQ;QAAID,UAAU;;;;;;QAG3DF,MAAM;QAAcC,MAAM;QAAQC,UAAU;;;;;;QAG5CF,MAAM;QAAcC,MAAM;QAAWE,QAAQ;QAAKD,UAAU;;;;;;QAI5DD,MAAM;;;;;;QAIID,MAAM;QAAcC,MAAM;;;;;gCAI7BG,gCAAY;QAAIC,UAAU;;;QAC7BL,MAAM;;;;;gCAGHM,gBAAI;;QACPN,MAAM;;;;;;;QA9DY;;;QACF;;;QACD;;;QACK;;;QACF;;;QACC;;;QACI;QAAY"}