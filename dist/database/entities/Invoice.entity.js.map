{"version":3,"sources":["../../../src/database/entities/Invoice.entity.ts"],"sourcesContent":["import { Entity, PrimaryGeneratedColumn, Column, CreateDateColumn, UpdateDateColumn, DeleteDateColumn, ManyToOne, JoinColumn, OneToMany, Index } from 'typeorm';\nimport { User } from './User.entity';\nimport { CalculationItem } from './CalculationItem.entity';\n\n/**\n * Invoice Types\n */\nexport type InvoiceStatus = 'draft' | 'sent' | 'viewed' | 'paid' | 'overdue' | 'cancelled';\nexport type PaymentMethod = 'cash' | 'card' | 'bank_transfer' | 'wayforpay';\n\n/**\n * Invoice Entity\n */\n@Entity('invoices')\n@Index('idx_invoices_tenant_id', ['tenantId'])\n@Index('idx_invoices_client_id', ['clientId'])\n@Index('idx_invoices_status', ['status'])\n@Index('idx_invoices_invoice_date', ['invoiceDate'])\nexport class Invoice {\n    @PrimaryGeneratedColumn('uuid')\n    id: string;\n\n    @Column({ name: 'tenant_id', type: 'uuid' })\n    tenantId: string;\n\n    // Client Reference\n    @Column({ name: 'client_id', type: 'uuid', nullable: true })\n    clientId: string;\n\n    // Invoice Details\n    @Column({ type: 'varchar', length: 50 })\n    invoiceNumber: string;\n\n    @Column({ name: 'invoice_date', type: 'date' })\n    invoiceDate: Date;\n\n    @Column({ name: 'due_date', type: 'date', nullable: true })\n    dueDate: Date;\n\n    @Column({ type: 'text', nullable: true })\n    description: string;\n\n    // Amounts\n    @Column({ name: 'subtotal', type: 'decimal', precision: 14, scale: 2, nullable: true })\n    subtotal: number;\n\n    @Column({ name: 'discount_amount', type: 'decimal', precision: 14, scale: 2, default: 0 })\n    discountAmount: number;\n\n    @Column({ name: 'vat_amount', type: 'decimal', precision: 14, scale: 2, nullable: true })\n    vatAmount: number;\n\n    @Column({ name: 'total_amount', type: 'decimal', precision: 14, scale: 2, nullable: true })\n    totalAmount: number;\n\n    @Column({ name: 'paid_amount', type: 'decimal', precision: 14, scale: 2, default: 0 })\n    paidAmount: number;\n\n    @Column({ name: 'currency', type: 'varchar', length: 3, default: 'UAH' })\n    currency: string;\n\n    // Status\n    @Column({\n        type: 'varchar',\n        default: 'draft'\n    })\n    status: InvoiceStatus;\n\n    paymentMethod: PaymentMethod;\n\n    @Column({ name: 'payment_reference', type: 'varchar', length: 255, nullable: true })\n    paymentReference: string;\n\n    @Column({ name: 'paid_at', type: 'datetime', nullable: true })\n    paidAt: Date;\n\n    // PDF\n    @Column({ name: 'pdf_url', type: 'text', nullable: true })\n    pdfUrl: string;\n\n    @Column({ name: 'pdf_generated_at', type: 'datetime', nullable: true })\n    pdfGeneratedAt: Date;\n\n    // Notes\n    @Column({ type: 'text', nullable: true })\n    internalNotes: string;\n\n    @Column({ type: 'text', nullable: true })\n    clientNotes: string;\n\n    // Metadata\n    @Column({ type: 'json' })\n    metadata: Record<string, any>;\n\n    // Soft Delete\n    @DeleteDateColumn({ name: 'deleted_at', type: 'datetime' })\n    deletedAt: Date;\n\n    // Timestamps\n    @CreateDateColumn({ name: 'created_at', type: 'datetime' })\n    createdAt: Date;\n\n    @UpdateDateColumn({ name: 'updated_at', type: 'datetime' })\n    updatedAt: Date;\n\n    @Column({ name: 'created_by', type: 'uuid', nullable: true })\n    createdBy: string;\n\n    @Column({ name: 'updated_by', type: 'uuid', nullable: true })\n    updatedBy: string;\n\n    // Relations\n    @ManyToOne(() => User, { nullable: true })\n    @JoinColumn({ name: 'created_by' })\n    createdByUser: User;\n\n    @OneToMany(() => CalculationItem, (item) => item.invoice)\n    items: CalculationItem[];\n}\n"],"names":["Invoice","name","type","nullable","length","precision","scale","default","User","CalculationItem","item","invoice"],"mappings":";;;;+BAkBaA;;;eAAAA;;;yBAlByI;4BACjI;uCACW;;;;;;;;;;AAgBzB,IAAA,AAAMA,UAAN,MAAMA;AAoGb;;;;;;;QAhGcC,MAAM;QAAaC,MAAM;;;;;;QAIzBD,MAAM;QAAaC,MAAM;QAAQC,UAAU;;;;;;QAI3CD,MAAM;QAAWE,QAAQ;;;;;;QAGzBH,MAAM;QAAgBC,MAAM;;;;;;QAG5BD,MAAM;QAAYC,MAAM;QAAQC,UAAU;;;;;;QAG1CD,MAAM;QAAQC,UAAU;;;;;;QAIxBF,MAAM;QAAYC,MAAM;QAAWG,WAAW;QAAIC,OAAO;QAAGH,UAAU;;;;;;QAGtEF,MAAM;QAAmBC,MAAM;QAAWG,WAAW;QAAIC,OAAO;QAAGC,SAAS;;;;;;QAG5EN,MAAM;QAAcC,MAAM;QAAWG,WAAW;QAAIC,OAAO;QAAGH,UAAU;;;;;;QAGxEF,MAAM;QAAgBC,MAAM;QAAWG,WAAW;QAAIC,OAAO;QAAGH,UAAU;;;;;;QAG1EF,MAAM;QAAeC,MAAM;QAAWG,WAAW;QAAIC,OAAO;QAAGC,SAAS;;;;;;QAGxEN,MAAM;QAAYC,MAAM;QAAWE,QAAQ;QAAGG,SAAS;;;;;;QAK7DL,MAAM;QACNK,SAAS;;;;;;QAMHN,MAAM;QAAqBC,MAAM;QAAWE,QAAQ;QAAKD,UAAU;;;;;;QAGnEF,MAAM;QAAWC,MAAM;QAAYC,UAAU;;;;;;QAI7CF,MAAM;QAAWC,MAAM;QAAQC,UAAU;;;;;;QAGzCF,MAAM;QAAoBC,MAAM;QAAYC,UAAU;;;;;;QAItDD,MAAM;QAAQC,UAAU;;;;;;QAGxBD,MAAM;QAAQC,UAAU;;;;;;QAIxBD,MAAM;;;;;;QAIID,MAAM;QAAcC,MAAM;;;;;;QAI1BD,MAAM;QAAcC,MAAM;;;;;;QAG1BD,MAAM;QAAcC,MAAM;;;;;;QAGpCD,MAAM;QAAcC,MAAM;QAAQC,UAAU;;;;;;QAG5CF,MAAM;QAAcC,MAAM;QAAQC,UAAU;;;;;gCAIrCK,gBAAI;QAAIL,UAAU;;;QACrBF,MAAM;;;;;gCAGHQ,sCAAe,GAAGC,OAASA,KAAKC,OAAO;;;;;;QAtG1B;;;QACA;;;QACH;;;QACM"}