{"version":3,"sources":["../../../src/database/entities/Document.entity.ts"],"sourcesContent":["import { Entity, PrimaryGeneratedColumn, Column, CreateDateColumn, UpdateDateColumn, DeleteDateColumn, ManyToOne, JoinColumn, Index } from 'typeorm';\n\nimport { User } from './User.entity';\nimport type { Case } from './Case.entity';\n\n/**\n * Document Types\n */\nexport type DocumentType = 'contract' | 'agreement' | 'court_order' | 'evidence' | 'invoice' | 'other';\n\nexport type DocumentStatus = 'draft' | 'uploading' | 'signed' | 'rejected' | 'archived';\n\n/**\n * Document Entity\n */\n@Entity('documents')\n@Index('idx_documents_tenant_id', ['tenantId'])\n@Index('idx_documents_case_id', ['caseId'])\n@Index('idx_documents_type', ['type'])\n@Index('idx_documents_status', ['status'])\n@Index('idx_documents_uploaded_by', ['uploadedBy'])\nexport class Document {\n    @PrimaryGeneratedColumn('uuid')\n    id: string;\n\n    @Column({ name: 'tenant_id', type: 'uuid' })\n    tenantId: string;\n\n    // Case Reference\n    @Column({ name: 'case_id', type: 'uuid', nullable: true })\n    caseId: string;\n\n    // Client Reference (optional, if not tied to case)\n    @Column({ name: 'client_id', type: 'uuid', nullable: true })\n    clientId: string;\n\n    // Document Details\n    @Column({ name: 'file_name', type: 'varchar', length: 500 })\n    fileName: string;\n\n    @Column({ name: 'original_name', type: 'varchar', length: 500 })\n    originalName: string;\n\n    @Column({\n        type: 'varchar',\n    })\n    type: DocumentType;\n\n    @Column({ name: 'mime_type', type: 'varchar', length: 100, nullable: true })\n    mimeType: string;\n\n    @Column({ name: 'file_size', type: 'bigint', nullable: true })\n    fileSize: number;\n\n    @Column({ type: 'text', nullable: true })\n    description: string;\n\n    @Column({\n        type: 'varchar',\n        default: 'uploading'\n    })\n    status: DocumentStatus;\n\n    // File Storage\n    @Column({ name: 'storage_path', type: 'text', nullable: true })\n    storagePath: string;\n\n    @Column({ name: 'cdn_url', type: 'text', nullable: true })\n    cdnUrl: string;\n\n    @Column({ name: 'signed_url', type: 'text', nullable: true })\n    signedUrl: string;\n\n    // Digital Signature\n    @Column({ name: 'signature_hash', type: 'varchar', length: 255, nullable: true })\n    signatureHash: string;\n\n    @Column({ name: 'signature_algorithm', type: 'varchar', length: 50, nullable: true })\n    signatureAlgorithm: string;\n\n    @Column({ name: 'signed_at', type: 'datetime', nullable: true })\n    signedAt: Date;\n\n    @Column({ name: 'signed_by', type: 'uuid', nullable: true })\n    signedBy: string;\n\n    // Upload Info\n    @Column({ name: 'uploaded_by', type: 'uuid' })\n    uploadedBy: string;\n\n    @Column({ name: 'uploaded_at', type: 'datetime' })\n    uploadedAt: Date;\n\n    @Column({ name: 'upload_ip', type: 'varchar', length: 45, nullable: true })\n    uploadIp: string;\n\n    // Versioning\n    @Column({ name: 'version', type: 'int', default: 1 })\n    version: number;\n\n    @Column({ name: 'parent_document_id', type: 'uuid', nullable: true })\n    parentDocumentId: string;\n\n    // Access Control\n    accessLevel: 'public' | 'internal' | 'confidential';\n\n    // Soft Delete\n    @DeleteDateColumn({ name: 'deleted_at', type: 'datetime' })\n    deletedAt: Date;\n\n    // Timestamps\n    @CreateDateColumn({ name: 'created_at', type: 'datetime' })\n    createdAt: Date;\n\n    @UpdateDateColumn({ name: 'updated_at', type: 'datetime' })\n    updatedAt: Date;\n\n    @Column({ name: 'created_by', type: 'uuid', nullable: true })\n    createdBy: string;\n\n    @Column({ name: 'updated_by', type: 'uuid', nullable: true })\n    updatedBy: string;\n\n    // Relations (require to avoid circular dependency with Case.entity)\n    @ManyToOne(() => require('./Case.entity').Case, { nullable: true })\n    @JoinColumn({ name: 'case_id' })\n    case: Case;\n\n    @ManyToOne(() => User, { nullable: true })\n    @JoinColumn({ name: 'signed_by' })\n    signedByUser: User;\n\n    @ManyToOne(() => User)\n    @JoinColumn({ name: 'uploaded_by' })\n    uploadedByUser: User;\n}\n"],"names":["Document","name","type","nullable","length","default","require","Case","User"],"mappings":";;;;+BAqBaA;;;eAAAA;;;yBArB8H;4BAEtH;;;;;;;;;;AAmBd,IAAA,AAAMA,WAAN,MAAMA;AAkHb;;;;;;;QA9GcC,MAAM;QAAaC,MAAM;;;;;;QAIzBD,MAAM;QAAWC,MAAM;QAAQC,UAAU;;;;;;QAIzCF,MAAM;QAAaC,MAAM;QAAQC,UAAU;;;;;;QAI3CF,MAAM;QAAaC,MAAM;QAAWE,QAAQ;;;;;;QAG5CH,MAAM;QAAiBC,MAAM;QAAWE,QAAQ;;;;;;QAItDF,MAAM;;;;;;QAIAD,MAAM;QAAaC,MAAM;QAAWE,QAAQ;QAAKD,UAAU;;;;;;QAG3DF,MAAM;QAAaC,MAAM;QAAUC,UAAU;;;;;;QAG7CD,MAAM;QAAQC,UAAU;;;;;;QAI9BD,MAAM;QACNG,SAAS;;;;;;QAKHJ,MAAM;QAAgBC,MAAM;QAAQC,UAAU;;;;;;QAG9CF,MAAM;QAAWC,MAAM;QAAQC,UAAU;;;;;;QAGzCF,MAAM;QAAcC,MAAM;QAAQC,UAAU;;;;;;QAI5CF,MAAM;QAAkBC,MAAM;QAAWE,QAAQ;QAAKD,UAAU;;;;;;QAGhEF,MAAM;QAAuBC,MAAM;QAAWE,QAAQ;QAAID,UAAU;;;;;;QAGpEF,MAAM;QAAaC,MAAM;QAAYC,UAAU;;;;;;QAG/CF,MAAM;QAAaC,MAAM;QAAQC,UAAU;;;;;;QAI3CF,MAAM;QAAeC,MAAM;;;;;;QAG3BD,MAAM;QAAeC,MAAM;;;;;;QAG3BD,MAAM;QAAaC,MAAM;QAAWE,QAAQ;QAAID,UAAU;;;;;;QAI1DF,MAAM;QAAWC,MAAM;QAAOG,SAAS;;;;;;QAGvCJ,MAAM;QAAsBC,MAAM;QAAQC,UAAU;;;;;;QAO1CF,MAAM;QAAcC,MAAM;;;;;;QAI1BD,MAAM;QAAcC,MAAM;;;;;;QAG1BD,MAAM;QAAcC,MAAM;;;;;;QAGpCD,MAAM;QAAcC,MAAM;QAAQC,UAAU;;;;;;QAG5CF,MAAM;QAAcC,MAAM;QAAQC,UAAU;;;;;gCAIrCG,QAAQ,iBAAiBC,IAAI;QAAIJ,UAAU;;;QAC9CF,MAAM;;;;;gCAGHO,gBAAI;QAAIL,UAAU;;;QACrBF,MAAM;;;;;gCAGHO,gBAAI;;QACPP,MAAM;;;;;;;QArHW;;;QACF;;;QACH;;;QACE;;;QACK"}